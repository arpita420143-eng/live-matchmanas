<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MKS Sports Live - Cricket HD</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --bg-color: #0f1016;
            --card-bg: #1e2130;
            --accent: #4fc3f7;
            --yt-color: #FF0000;
            --tg-color: #229ED9;
        }

        body {
            margin: 0; padding: 0; background-color: var(--bg-color); color: white;
            font-family: 'Segoe UI', sans-serif; text-align: center;
        }

        /* Header & Ticker */
        .header { background: linear-gradient(180deg, #1a237e 0%, #0f1016 100%); padding: 20px 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo-text { font-size: 26px; font-weight: 900; margin: 0; color: #fff; text-transform: uppercase; }
        .match-info { color: var(--accent); font-size: 14px; margin-top: 5px; font-weight: bold; }
        
        .news-ticker { background: #d32f2f; color: white; font-size: 13px; padding: 8px 0; overflow: hidden; }
        .ticker-content { display: inline-block; white-space: nowrap; animation: scroll 20s linear infinite; }
        @keyframes scroll { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        .container { max-width: 850px; margin: 20px auto; padding: 10px; }

        /* Server Tabs */
        .server-tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 15px; }
        .tab-btn { 
            background: #252839; color: white; border: 1px solid #444; 
            padding: 8px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;
            transition: 0.3s;
        }
        .tab-btn.active { background: var(--accent); color: #000; border-color: var(--accent); }

        /* Player Box */
        .player-box { background: var(--card-bg); padding: 12px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .live-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .live-badge { background: red; color: white; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: bold; display: flex; align-items: center; gap: 5px; }
        .live-dot { width: 6px; height: 6px; background: white; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        .quality-select { background: #000; color: #fff; border: 1px solid #555; border-radius: 4px; padding: 4px; font-size: 12px; }

        .video-wrapper { position: relative; width: 100%; padding-bottom: 56.25%; background: #000; border-radius: 8px; overflow: hidden; }
        .video-wrapper video, .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

        /* Buttons */
        .btn-container { margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { text-decoration: none; padding: 12px; border-radius: 8px; color: white; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-yt { background: var(--yt-color); }
        .btn-tg { background: var(--tg-color); }
    </style>
</head>
<body>

    <div class="header">
        <h1 class="logo-text">MKS Sports Live</h1>
        <div class="match-info">India vs New Zealand - 3rd ODI</div>
    </div>

    <div class="news-ticker">
        <div class="ticker-content">üî• Match Auto-Updating via Telegram ‚Ä¢ Join @MKSSports_3 for Live Links ‚Ä¢ Share with friends!</div>
    </div>

    <div class="container">
        <div class="server-tabs">
            <button class="tab-btn active" id="btn-s1" onclick="switchServer('direct')">Server 1 (Auto)</button>
            <button class="tab-btn" id="btn-s2" onclick="switchServer('backup')">Server 2 (Backup)</button>
        </div>

        <div class="player-box">
            <div class="live-bar">
                <div class="live-badge"><div class="live-dot"></div> LIVE</div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <select id="qualitySelect" class="quality-select" style="display:none;"></select>
                    <div style="font-size:12px; color:#aaa;">üëÅ <span id="viewers">142K</span></div>
                </div>
            </div>
            <div class="video-wrapper" id="videoContainer">
                <div style="color:white; padding: 50px;">Fetching Latest Stream...</div>
            </div>
        </div>

        <div class="btn-container">
            <a href="https://youtube.com/@mkssports3" class="btn btn-yt"><i class="fab fa-youtube"></i> YouTube</a>
            <a href="https://t.me/MKSSports_3" class="btn btn-tg"><i class="fab fa-telegram-plane"></i> Telegram</a>
        </div>
    </div>

    <script>
        const TG_CHANNEL = "MKSSports_3"; // Aapka Telegram Username
        const BACKUP_IFRAME = "https://cricketstan.github.io/Channel-14/";
        let currentHls = null;

        // 1. Fetch Link from Telegram
        async function getTgLink() {
            try {
                const proxy = "https://api.allorigins.win/get?url=";
                const target = `https://t.me/s/${TG_CHANNEL}`;
                const response = await fetch(proxy + encodeURIComponent(target));
                const data = await response.json();
                const regex = /https?:\/\/[^\s<>"]+\.m3u8[^\s<>"]*/g;
                const matches = data.contents.match(regex);
                return matches ? matches[matches.length - 1] : null;
            } catch (e) { return null; }
        }

        // 2. Switch Servers
        async function switchServer(type) {
            const container = document.getElementById('videoContainer');
            const qSelect = document.getElementById('qualitySelect');
            
            // UI Toggle
            document.getElementById('btn-s1').classList.toggle('active', type === 'direct');
            document.getElementById('btn-s2').classList.toggle('active', type === 'backup');

            if (type === 'direct') {
                container.innerHTML = '<div style="color:white; padding:50px;">Loading Server 1...</div>';
                const link = await getTgLink() || "https://jan.player0003.com/hls/star2eng.m3u8"; // Fallback link
                initPlayer(link);
            } else {
                qSelect.style.display = 'none';
                container.innerHTML = `<iframe src="${BACKUP_IFRAME}" allowfullscreen></iframe>`;
            }
        }

        // 3. HLS Player Engine
        function initPlayer(url) {
            const container = document.getElementById('videoContainer');
            const qSelect = document.getElementById('qualitySelect');
            container.innerHTML = "";
            
            const video = document.createElement('video');
            video.controls = true; video.autoplay = true; video.playsInline = true;
            container.appendChild(video);

            if (Hls.isSupported()) {
                if(currentHls) currentHls.destroy();
                const hls = new Hls();
                currentHls = hls;
                hls.loadSource(url);
                hls.attachMedia(video);
                
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    if (hls.levels.length > 1) {
                        qSelect.style.display = 'block';
                        qSelect.innerHTML = '<option value="-1">Auto Quality</option>';
                        hls.levels.forEach((l, i) => {
                            qSelect.innerHTML += `<option value="${i}">${l.height || 'HD'}p</option>`;
                        });
                        qSelect.onchange = () => hls.currentLevel = parseInt(qSelect.value);
                    }
                });
            } else {
                video.src = url;
            }
        }

        window.onload = () => switchServer('direct');
    </script>
</body>
</html>
